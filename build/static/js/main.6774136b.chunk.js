(this["webpackJsonphalloween-app"]=this["webpackJsonphalloween-app"]||[]).push([[0],{36:function(e,t,a){e.exports=a(60)},56:function(e,t,a){e.exports=a.p+"static/media/doorbell.e5ebc927.mp3"},57:function(e,t,a){},60:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(31),c=a.n(i),o=a(3),l=a(15),s=a(23),d=a(8),u=a(20),m=a(19),b=a(25),f=a.n(b),p=a(32),h=a(33),v=a(26),g=a.n(v),E={apiKey:"AIzaSyAmCghJdMvcKxDMCmQVQ2lDwvEM0e-DLQ4",authDomain:"halloween-candy-dispenser.firebaseapp.com",databaseURL:"https://halloween-candy-dispenser.firebaseio.com",projectId:"halloween-candy-dispenser",storageBucket:"halloween-candy-dispenser.appspot.com",messagingSenderId:"489903711579",appId:"1:489903711579:web:b31f80544c27adeb73667e"},x=new function e(){var t=this;Object(h.a)(this,e),this.rootRef=void 0,this.getCandies=function(){return new Promise((function(e,a){t.rootRef.child("candies").once("value",(function(t){e(Object.entries(t.val()).map((function(e){var t=Object(d.a)(e,2);return{id:t[0],name:t[1]}})))}))}))},this.subscribeToCandiesChanged=function(e){t.rootRef.child("candies").on("value",(function(t){t.exists()?e(Object.entries(t.val()).filter((function(e){var t=Object(d.a)(e,2);t[0];return t[1].available})).map((function(e){var t=Object(d.a)(e,2);return{id:t[0],name:t[1].name}}))):e([])}))},this.unSubscribeToCandiesChanged=function(){t.rootRef.child("candies").off("value")},this.subscribeToOrderSubmitted=function(e){t.rootRef.child("orders").on("child_added",function(){var a=Object(p.a)(f.a.mark((function a(n,r){var i;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.rootRef.child("candies").once("value");case 2:return a.next=4,a.sent.val();case 4:if(a.t0=a.sent,a.t0){a.next=7;break}a.t0={};case 7:i=a.t0,e({timestamp:new Date(+n.key),candies:n.val().split(",").map((function(e){var t;return{id:e,name:(null===(t=i[e])||void 0===t?void 0:t.name)||"no longer available"}}))});case 9:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}())},this.unSubscribeToOrderSubmitted=function(){t.rootRef.child("orders").off("child_added")},this.addCandy=function(e){var a=t.rootRef.child("candies").push().key;t.rootRef.child("candies").update(Object(l.a)({},a,{name:e,available:!0}))},this.removeCandy=function(e){t.rootRef.child("candies/".concat(e)).update({available:!1})},this.submitOrder=function(e){e.length>0&&t.rootRef.child("orders").update(Object(l.a)({},(new Date).getTime(),e.join(",")))},console.log("initializing firebase app."),g.a.initializeApp(E),this.rootRef=g.a.database().ref()},y=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=t[0],i=t[1],c=Object(n.useState)({}),o=Object(d.a)(c,2),b=o[0],f=o[1];return Object(n.useEffect)((function(){return x.subscribeToCandiesChanged((function(e){i(e)})),function(){return x.unSubscribeToCandiesChanged()}}),[]),r.a.createElement("div",{className:"max-w-md p-2 z-10"},r.a.createElement("h2",{className:"large-title"}," Choose your candy:"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),x.submitOrder(Object.entries(b).filter((function(e){var t=Object(d.a)(e,2);t[0];return t[1]})).map((function(e){var t=Object(d.a)(e,2),a=t[0];t[1];return a}))),f({})}},a.map((function(e){return r.a.createElement("div",{className:"inline-block w-1/2 p-1"},r.a.createElement("label",{key:e.id,className:"inline-block flex items-center p-2 border-2 border-white rounded "+(b[e.id]?"bg-white text-theme-dark":"")},r.a.createElement("input",{className:"hidden",type:"checkbox",checked:b[e.id],onChange:function(t){return a=e.id,void f((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(l.a)({},a,!e[a]))}));var a}}),r.a.createElement(m.a,{icon:u.a,className:"mr-2 "+(b[e.id]?"":"opacity-0")}),e.name))})),r.a.createElement("button",{type:"submit",className:"bg-gradient-to-r from-theme-yellow to-theme-orange mt-4 text-shadow-black w-full py-1 text-lg font-bold italic uppercase tracking-wide rounded"},"submit")))},w=a(34),O=a(56),j=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=t[0],i=t[1],c=Object(n.useState)([]),o=Object(d.a)(c,2),l=o[0],s=o[1],b=Object(n.useState)(""),f=Object(d.a)(b,2),p=f[0],h=f[1],v=Object(w.a)(O),g=Object(d.a)(v,1)[0];Object(n.useEffect)((function(){console.log("useEffect");var e=!1;return setInterval((function(){return e=!0}),1500),x.subscribeToCandiesChanged((function(e){return s(e)})),x.subscribeToOrderSubmitted((function(t){e&&g(),i((function(e){return[t].concat(e)}))})),function(){x.unSubscribeToCandiesChanged(),x.unSubscribeToOrderSubmitted(),i([])}}),[g]);return r.a.createElement("div",{className:"max-w-md p-2 z-10"},r.a.createElement("h2",{className:"large-title"},"Orders:"),r.a.createElement("ul",{className:"divide-y divide-white divide-opacity-25 ml-2"},0===a.length&&r.a.createElement("p",null,"No orders to show."),a.map((function(e){var t;return r.a.createElement("li",{key:null===(t=e.timestamp)||void 0===t?void 0:t.getTime(),className:"px-2 py-1"},r.a.createElement("strong",null,function(e){if(!e)return"";var t=function(e){return("00"+e).slice(-2)};return"".concat(t(e.getHours()),":").concat(t(e.getMinutes()))}(e.timestamp),"\xa0\xa0"),e.candies.map((function(e){return e.name})).join(", "))}))),r.a.createElement("h2",{className:"large-title"}," Current candies:"),r.a.createElement("ul",{className:"divide-y divide-white divide-opacity-25 ml-2"},0===a.length&&r.a.createElement("p",null,"No candies to show."),l.map((function(e){return r.a.createElement("li",{key:e.id,className:"px-2 py-1 flex items-center"},e.name," ",r.a.createElement("button",{onClick:function(){return x.removeCandy(e.id)},className:"text-red-600 border border-red-800 px-1 ml-3 text-xs rounded"},r.a.createElement(m.a,{icon:u.b,className:"mr-1"}),"delete"))}))),r.a.createElement("span",{className:"mt-2 ml-2 font-bold"},"Add candy:"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),x.addCandy(p),h("")}},r.a.createElement("input",{className:"rounded-l px-2 py-1 ml-4 text-theme-dark",type:"text",value:p,onChange:function(e){return h(e.target.value)}}),r.a.createElement("button",{type:"submit",className:"rounded-r py-1 px-2 bg-theme-green uppercase italic font-bold tracking-wide text-white text-shadow-black"},"Add")))},N=(a(57),a(17)),k=function(){return r.a.createElement("div",{className:"max-w-md p-2 z-10 leading-tight"},r.a.createElement("h2",{className:"large-title"},"I am:"),r.a.createElement("div",{className:"flex"},r.a.createElement(N.b,{className:"flex-initial text-center m-1 inline-block py-2 px-4 border-2 border-white rounded hover:bg-white hover:text-theme-dark",to:"/requester"},"requesting candy"),r.a.createElement(N.b,{className:"flex-initial text-center m-1 inline-block py-2 px-4 border-2 border-white rounded hover:bg-white hover:text-theme-dark",to:"/sender"},"sending candy")))};var C=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"hidden sm:inline fixed bg-ghosts bg-repeat-y h-screen w-48 z-0 bg-contain ml-4 md:ml-12 lg:ml-32 opacity-75 left-0 top-0"}),r.a.createElement(o.c,null,r.a.createElement(o.a,{path:"/requester",exact:!0},r.a.createElement(y,null)),r.a.createElement(o.a,{path:"/sender",exact:!0},r.a.createElement(j,null)),r.a.createElement(o.a,{path:"/",exact:!0},r.a.createElement(k,null))))};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(N.a,{basename:"/trickOrTreat"},r.a.createElement(C,null))),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.6774136b.chunk.js.map